# Digraph I/O-Degree Entropy Analysis -- Understanding Discrete Dynamics via Topological Flow Data Analysis

このプロジェクトでは，ワードの為す離散力学系を有向グラフとして解析します．
2次元非圧縮流れの流線図をトポロジーの意味で一意に分類することができ，その分類に対応するCOT表現と呼ばれる特別なワードがスナップショット毎に計算されています．
事前に計算した関連データがtsvファイルにまとめられています．

## Version 管理

この解析プログラムプロジェクトはあくまで実験的なものです．言い換えると，「使い捨て」です．しかし，最低限の git 管理を local のみで行います．`git init` してバージョン管理を開始しました．（2025-12-26 開始）

サブタスクを完了する毎にバージョン管理（コミット）することを忘れないでください．

## Python 環境 -- uv

軽量な uv プロジェクトとして準備しました．`networkx`, `pandas`, `scipy` を依存関係として定義しています．

## Colab Notebook への export plan

現在用意してある `tsv/` 以下のデータは，ほんの一部です．最終的には全てのデータを Colab ノートブック上で解析する予定です．全データは Google Drive に配置してあります．

Google Drive へのマウントからデータの読み込みを行うノートブックはこちらで準備します．このプロジェクトでは，Colab ノートブックから使われる前提で，特定のデータファイルに依存しないよう抽象化したグラフ解析のための Python モジュール部分と，テストデータを用いたテスト解析プログラムを提供してください．

### Colab からのインストール方法

このリポジトリは GitHub 経由で直接 pip install できます．Colab ノートブックでは以下のコマンドを実行してください：

```python
!pip install git+https://github.com/t-uda/digraph-io-analysis.git
```

インストール後は以下のようにモジュールをインポートできます：

```python
from digraph_inout_analysis.core import build_transition_graph, calculate_entropy, export_to_gephi
```

## tsv ファイルの中身と有向グラフ作成

各時刻 `time` の `sub_cot` 列を離散力学系とみなしてください．`error` エントリは多くの場合短いタイムスケールであるため，スキップしてください．つまり，時刻 `t` からしばらくあとの時刻 `t+n` まで `error` があった場合，その行の `sub_cot` データはないものとみなして，`t-1` から `t+n+1` への有向辺を作成します．

## 有向グラフ解析

状態 (word) A から状態 (word) B への遷移を以下の要領で解析します．

単なる A から B への遷移回数だけでなく，**「A から B へ遷移した後，次にどこへ遷移するか」** という 2-step の履歴（軌道）情報を保持します．
すなわち，有向辺 $A \to B$ に対して，その次に来る状態 $C_i$ の分布をカウントします．

*   分母：軌道 $A \to B$ の総出現回数
*   分子：軌道 $A \to B \to C_i$ の出現回数

これにより，条件付き確率 $P(C_i | B, A)$ を求めます．これは，「今 B にいて，かつ直前に A から来た場合」の次の状態の確率分布です．
この分布に対して Shannon entropy を計算し，その値を各有向辺 $A \to B$ に割り当てます．これにより，単純なノードの分岐ではなく，文脈（前状態）に依存したダイナミクスの不確実性を可視化します．

計算された entropy を属性として持つ digraph を Gephi 形式で出力してください．

